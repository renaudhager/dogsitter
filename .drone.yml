---
kind: pipeline
name: lint
clone:
  git:
    image: plugins/git
    tags: true

steps:
- name: lint
  image: renaudhager/go-ci:latest
  commands:
  - make deps
  - make lint

---
kind: pipeline
name: test
clone:
  git:
    image: plugins/git
    tags: true

steps:
- name: test
  image: renaudhager/go-ci:latest
  commands:
  - make deps
  - make test
  - bash <(curl -s https://codecov.io/bash)
  environment:
    CODECOV_TOKEN:
      from_secret: CODECOV_TOKEN

---
kind: pipeline
name: build
clone:
  git:
    image: plugins/git
    tags: true

steps:
- name: build
  image: renaudhager/go-ci:latest
  commands:
  - make deps
  - make build

depends_on:
  - lint
  - test

---
kind: signature
hmac: c8a1671445310f7e7662292164ed9a0cb034fbc9b51c282d41783c1bcc9f0079

...
